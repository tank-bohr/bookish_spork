language: erlang

otp_release:
  - 20.3
  - 21.1

env:
  - DEPS_BIN=$HOME/.deps-bin

before_install:
  - scripts/install-deps.sh
  - export PATH=$DEPS_BIN:$PATH

script:
  - make

after_success:
  - make coverage

deploy:
  provider: script
  script: bash scripts/publish.sh
  on:
    tags: true

cache:
  directories:
    - $DEPS_BIN
    - $HOME/.cache/rebar3
